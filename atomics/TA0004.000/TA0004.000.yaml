attack_technique: TA0004.000
display_name: AWS Privilege Escalation using CreatePolicyVersion
atomic_tests:
- name: Create victim
  auto_generated_guid: 8822c3b0-d9f9-4daf-a043-49f460a31122
  description: |
    Create AWS IAM Users -Victim
  supported_platforms:
  - macos
  - linux
  input_arguments:
    victim:
      description: Username of the IAM user to create - Victim
      type: String
      default: "AtomicRedTeam_Victim"
  executor:
    command: |
      aws iam create-user --user-name #{victim}
    cleanup_command: |
      aws iam delete-user --user-name #{victim}

    name: sh

- name: Setup test user 
  auto_generated_guid: 8822c3b0-d9f9-4daf-a043-49f460a31122
  description: |
    Create AWS IAM Users  - Test Account
  supported_platforms:
  - macos
  - linux
  input_arguments:
    test_user:
      description: Username of the IAM user to test and verify the attack
      type: String
      default: "AtomicRedTeam_Test"
  executor:
    command: |
      aws iam create-user --user-name #{test_user}
    cleanup_command: |
      aws iam delete-user --user-name #{test_user}
    name: sh

